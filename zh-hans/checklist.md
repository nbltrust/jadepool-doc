### 关于区块链接入的实现审查
- 基本信息
	- 明确区块链类型：标准区块链，DAG类型等
	- 明确共识机制：PoW，PoS，DPoS，BFT等
	- 确认地址规则：独立账号型，公钥转化型
	- 确认衍生占用的coinType index（来自： https://github.com/satoshilabs/slips/blob/master/slip-0044.md）
	- 确认交易是否支持带Memo发送（通过Memo区分用户可降低内部损耗）
	- 确认是否支持添加扩展代币
	- 确认节点保持连接的机制，以及节点的使用方式（需支持选择最优节点）
	- 确认扫描交易的方式（按区块号，按地址）
	- 确认私钥 -> 公钥及签名的加密算法
	- 确认公钥 -> 地址的转化规则（若为公钥转化型）
		- 是否存在不同类型的地址规则
		- 是否需要支持不同类型的地址规则
	- 确认地址余额的模式
		- 数值模式
		- 资源模式（例如：UTXO类）
	- 确认转账交易的模式
		- 一对一
		- 一对多
		- 多对多
- 交易安全确认机制
	- 出块即确认，例如：BFT共识
	- 存在不可逆区块，例如：EOS的DPoS
	- 从分叉概率预估的确认数，例如：PoW共识
	- 预估确认数+已同步的超级节点占比，例如：PoS共识
	- 账户独立无确认数+已同步的超级节点占比，例如：例如DAG类型区块链
- 入金检测
	- 检测交易必须为系统支持的代币
		- 若为普通资产代币，需检测该资产id是否与区块链上一致
		- 若为智能合约代币，需检测该代币合约是否为区块链上的合约地址
	- 检测交易的目标地址必须为内部地址
	- 创建入账订单
		- 若区块链支持多目标转账，需在检测中识别出多目标，同时根据index给予唯一编号
		- 每个入账目标需确认在系统中不存在已创建的相同订单
- 出金实现
	- 创建出金订单
		- 瑶池系统已完成了对出金订单创建的相关业务逻辑，该类型订单请求由应用方或瑶池系统发起
		- 若区块支持Memo功能，需注意在交易发送时添加memo
	- 手续费预估
		- 确认手续费的计算规则
		- 确认手续费消耗的代币是否为本身
		- 若消耗的手续费非本身，需实现相应的内部授权或转账机制以保证交易正常进行
	- 订单交易发送
		- 需支持批量实现，若区块链仅支持一对一账，则需要通过相关机制将不同的订单加入到区块链的Mempool
		- 每一次批交易发送后，需确认是否要等待这批交易上链再进行下一批。
		- 订单Rollback机制
			- 当正式交易发送前，订单将处于冻结状态，实现中需确保该订单处于可发送状态
			- 若该订单无法发送，则需要在发送前即将该订单rollback回待发送状态。
			- 一旦交易向节点发送上链请求，该订单将不可再rollback
		- 错误处理
			- 当交易发送到节点时出现的任何异常，都需及时捕获
			- 将订单保持在冻结状态，并设置错误信息
			- 发送异常通知给运营人员，人工介入进行异常处理
- 交易检测和订单状态更新
	- 关于确认中状态的认定
		- 若未达到安全确认条件，保持为确认中
		- 若在节点上临时未找到该交易，则在最终失败认定前，保持为确认中
	- 关于最终成功的认定
		- 判断该交易是否达到安全确认的条件
		- 按照区块链规则验证该交易是否成功
		- 若为合约交易，根据智能合约规则验证合约运行是否最终成功
		- 完全上述认定条件，即为最终成功
	- 关于最终失败的认定
		- 在节点上找到该交易
			- 根据交易结果信息，若节点明确为交易失败（gas不够等），即认为最终失败
		- 在节点上未找到该交易
			- 若区块链存在过期机制，根据订单中保存的过期参数判定，若该交易过期即认为最终失败
			- 若不存在过期机制，若达到该区块链大概率安全失败的条件，则即可认为该交易过期

### 关于扩展代币的合约审查
- 尽量选择以开放源代码的智能合约进行支持
- 检查该智能合约完全满足转账相关的标准规则（例如ETH类需实现ERC20标准，Eos类需继承自eosio.token）
- 检查合约代码实现中是否规避了常见的漏洞（以EVM举例）
	- 值类型越界问题（可使用SafeMath规避）
	- 任何Error都需要正常抛出
	- 值类型修改后，需发出Transfer Event以告知交易正常
- 检查合约代码实现中是否植入了盗用签名，恶意授权等恶意代码